# MCP 實戰示範

本文件示範如何實際使用 Chrome DevTools MCP 測試 GAS Web App。

## 📋 目前部署資訊

```
部署 ID: AKfycbzO6IZqMy05KL87qoxATHS9xXJldYk4VBsor42WQyEO
類型: @HEAD (最新版本)
```

## 🎯 示範場景

### 場景 1：基本頁面測試

**目標**：驗證 Web App 介面正常運作

**AI 指令**：
```
請測試 GAS Web App：
1. 開啟頁面（如果尚未開啟）
2. 擷取頁面文字快照
3. 確認包含「GAS 開發測試工具」
4. 確認包含「重新載入資料」按鈕
5. 擷取截圖
```

**預期結果**：
- ✅ 頁面標題顯示「GAS 開發測試工具」
- ✅ 包含統計卡片區域
- ✅ 包含三個按鈕（重新載入、下載、執行測試）

---

### 場景 2：資料載入測試

**目標**：驗證 API 資料載入功能

**AI 指令**：
```
請測試資料載入：
1. 在頁面中執行 loadData()
2. 等待 3 秒
3. 執行 JavaScript: currentData
4. 驗證 currentData.exam 物件存在
5. 檢查 currentData.exam.population 是否為數字
6. 顯示統計資訊
```

**預期結果**：
- ✅ currentData 包含完整 exam 物件
- ✅ population 為正整數
- ✅ 包含 sessionDistribution 統計
- ✅ 包含 departmentDistribution 統計

---

### 場景 3：API 請求驗證

**目標**：驗證 API 端點回傳正確資料

**AI 指令**：
```
請驗證 API 請求：
1. 列出所有網路請求
2. 找到包含 mode=api 的請求
3. 取得該請求的回應內容
4. 解析 JSON 並驗證結構：
   - exam.population 存在
   - exam.sessionCount 存在
   - exam.statistics 存在
5. 顯示關鍵統計資料
```

**預期結果**：
- ✅ API 請求成功（200 OK）
- ✅ Content-Type 為 application/json
- ✅ JSON 結構完整
- ✅ 統計資料正確

---

### 場景 4：互動測試

**目標**：測試使用者互動功能

**AI 指令**：
```
請測試按鈕互動：
1. 擷取頁面快照找到「重新載入資料」按鈕
2. 點擊該按鈕
3. 等待 2 秒
4. 執行 JavaScript 檢查 currentData 是否更新
5. 截圖顯示更新後的畫面
```

**預期結果**：
- ✅ 按鈕可點擊
- ✅ 點擊後資料重新載入
- ✅ 統計卡片更新
- ✅ JSON 輸出區更新

---

### 場景 5：效能測試

**目標**：測量 API 回應時間與頁面效能

**AI 指令**：
```
請進行效能測試：
1. 啟動效能追蹤
2. 重新載入頁面
3. 停止追蹤
4. 分析 Core Web Vitals：
   - LCP (Largest Contentful Paint)
   - FID (First Input Delay)
   - CLS (Cumulative Layout Shift)
5. 分析 API 請求時間
6. 產生效能報告
```

**預期結果**：
- ✅ LCP < 2.5s
- ✅ FID < 100ms
- ✅ CLS < 0.1
- ✅ API 回應時間 < 2s

---

### 場景 6：錯誤處理測試

**目標**：驗證錯誤處理機制

**AI 指令**：
```
請測試錯誤處理：
1. 執行 JavaScript: 
   fetch('invalid-url').catch(e => console.error(e))
2. 列出 Console 訊息
3. 確認錯誤被正確捕捉
4. 驗證頁面仍可正常運作
```

**預期結果**：
- ✅ 錯誤訊息出現在 Console
- ✅ 頁面不會崩潰
- ✅ 其他功能仍可使用

---

## 🔄 完整測試流程

### 步驟 1：環境準備

```bash
# 確保最新程式碼已推送
npm run push

# 檢查部署狀態
clasp deployments
```

### 步驟 2：開啟 Web App

在 VS Code Chat 中：
```
請開啟 GAS Web App 進行測試
```

或手動在 Chrome 開啟部署 URL。

### 步驟 3：執行自動化測試

在 VS Code Chat 中：
```
請執行完整的 Web App 測試流程：

1. **頁面驗證**
   - 擷取快照確認介面載入
   - 檢查所有按鈕存在

2. **功能測試**
   - 測試資料載入
   - 測試按鈕點擊
   - 驗證資料正確性

3. **效能測試**
   - 測量載入時間
   - 檢查 API 回應速度

4. **產出報告**
   - 截圖關鍵畫面
   - 列出測試結果
   - 標記通過/失敗項目
```

### 步驟 4：檢視結果

AI 會自動：
- ✅ 執行所有測試步驟
- ✅ 產生截圖
- ✅ 收集效能數據
- ✅ 產生測試報告

---

## 🐛 除錯示範

### 當資料顯示異常時

**AI 指令**：
```
資料顯示異常，請協助除錯：

1. 執行 debugExamObject() 查看伺服器端資料
2. 在瀏覽器執行 currentData 查看客戶端資料
3. 比較兩者差異
4. 檢查 Network 請求是否成功
5. 查看 Console 是否有錯誤
6. 截圖當前狀態
7. 產生除錯報告
```

### 當效能緩慢時

**AI 指令**：
```
頁面載入緩慢，請分析原因：

1. 啟動詳細效能追蹤
2. 重新載入頁面
3. 分析 LCPBreakdown insight
4. 列出所有網路請求及耗時
5. 找出最慢的 3 個資源
6. 檢查是否有阻塞渲染的資源
7. 提供優化建議
```

---

## 📊 測試檢查清單

每次部署後執行：

- [ ] 頁面正常載入
- [ ] 統計卡片顯示正確數字
- [ ] 重新載入按鈕功能正常
- [ ] 下載 JSON 功能正常
- [ ] API 回應時間 < 2s
- [ ] 無 JavaScript 錯誤
- [ ] 無 Console 警告
- [ ] LCP < 2.5s
- [ ] 在行動裝置上顯示正常（透過 resize）

---

## 🎓 學習練習

### 練習 1：建立自訂測試

建立自己的測試場景：
```
請建立一個測試驗證：
1. 節次數量正確
2. 科別數量正確
3. 總學生數與各節次加總一致
```

### 練習 2：效能優化

找出並優化效能瓶頸：
```
請分析並建議如何優化：
1. API 回應時間
2. JavaScript 執行時間
3. 頁面渲染時間
```

### 練習 3：自動化報告

建立自動化測試報告：
```
請執行所有測試並產生 Markdown 報告，包含：
- 測試時間
- 通過/失敗統計
- 關鍵截圖
- 效能數據
- 建議事項
```

---

## 💡 提示與技巧

### 高效使用 MCP

1. **批次操作**：一次請求多個測試步驟
2. **具體描述**：明確指定要驗證的內容
3. **包含預期**：告訴 AI 預期結果
4. **要求截圖**：視覺化驗證很重要
5. **請求報告**：讓 AI 整理結果

### 常用指令範本

```
快速驗證：
「請快速檢查 Web App 是否正常」

深度測試：
「請執行完整測試並產生詳細報告」

效能分析：
「請分析效能並提供優化建議」

除錯協助：
「功能 X 異常，請協助找出原因」
```

---

## 🚀 下一步

1. **實際操作**：開啟 Web App 並執行場景 1
2. **自訂測試**：根據您的需求建立測試
3. **整合 CI/CD**：在部署流程中加入自動化測試
4. **分享經驗**：記錄有用的測試場景

開始使用 MCP 自動化您的測試流程！🎯
