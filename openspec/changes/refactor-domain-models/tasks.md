## ğŸš€ æ•ˆèƒ½å„ªåŒ–æ›´æ–°ï¼ˆ2025-12-05ï¼‰

> **é—œéµæ–‡ä»¶**ï¼š[OPTIMIZATION_REVIEW.md](OPTIMIZATION_REVIEW.md) - GAS æ•ˆèƒ½æœ€ä½³åŒ–å®Œæ•´æŒ‡å—

ç¶“åˆ†æç™¼ç¾ç›®å‰å¯¦ä½œå­˜åœ¨ **I/O æ•ˆç‡å•é¡Œ**ï¼Œé•å Google Apps Script å®˜æ–¹ Best Practicesã€‚å»ºè­°åœ¨éšæ®µ 6 æ¸¬è©¦å‰å…ˆåŸ·è¡Œæ•ˆèƒ½å„ªåŒ–ï¼š

### Google Apps Script æ•ˆèƒ½æœ€ä½³å¯¦å‹™ï¼ˆå®˜æ–¹ï¼‰

1. **æœ€å°åŒ–å°å¤–éƒ¨æœå‹™çš„å‘¼å«** - ç´” JavaScript é‹ç®—æ¯”å‘¼å« Google æœå‹™å¿«å¾—å¤š
2. **ä½¿ç”¨æ‰¹æ¬¡æ“ä½œ** - ä¸€æ¬¡è®€å–æ‰€æœ‰è³‡æ–™ï¼Œè™•ç†å¾Œä¸€æ¬¡å¯«å›
3. **é¿å…äº¤æ›¿è®€å¯«** - å°‡è®€å–é›†ä¸­åœ¨å‰é¢ï¼Œå¯«å…¥é›†ä¸­åœ¨å¾Œé¢

### ç•¶å‰å•é¡Œ

ç›®å‰æ¯å€‹æ’ç¨‹å‡½å¼éƒ½ç¨ç«‹å‘¼å« `createExamFromSheet()` å’Œ `saveExamToSheet()`ï¼ŒPipeline åŸ·è¡Œæ™‚é€ æˆ **16-20 æ¬¡ I/O æ“ä½œ**ã€‚

### å„ªåŒ–ç›®æ¨™

å°‡ I/O å¾ 16-20 æ¬¡é™è‡³ **2-4 æ¬¡**ï¼Œé æœŸåŸ·è¡Œæ™‚é–“æ¸›å°‘ **60-70%**ã€‚

---

## éšæ®µ 5.5: æ•ˆèƒ½å„ªåŒ–ï¼ˆğŸ”¥ å»ºè­°æ–°å¢ - é«˜å„ªå…ˆï¼‰

> åƒè€ƒ [OPTIMIZATION_REVIEW.md](OPTIMIZATION_REVIEW.md) çš„ã€Œæœ€ä½³åŒ–æ–¹æ¡ˆã€ç« ç¯€

#### 5.5.1 å»ºç«‹è³‡æ–™å­˜å–æ‰¹æ¬¡å‡½å¼
- [x] å»ºç«‹ `loadAllData()` å‡½å¼
  - ä¸€æ¬¡è®€å–ã€Œæ’å…¥è€ƒç¨‹çš„è£œè€ƒåå–®ã€å·¥ä½œè¡¨å…¨éƒ¨è³‡æ–™
  - ä¸€æ¬¡è®€å–ã€Œåƒæ•¸å€ã€ï¼ˆA1:F22ï¼‰
  - ä¸€æ¬¡è®€å–ã€Œç¯€æ¬¡æ™‚é–“è¡¨ã€
  - å›å‚³ `{ students, parameters, sessionTimes }`
  - **é©—æ”¶**ï¼šå–®æ¬¡å‡½å¼å‘¼å«å®Œæˆæ‰€æœ‰è®€å–ï¼Œå…± 3 æ¬¡ getValues

- [x] å»ºç«‹ `parseParameters(paramData)` å‡½å¼
  - è§£æåƒæ•¸é™£åˆ—ï¼šmaxSessionCount(B5), maxRoomCount(B6), maxStudentsPerRoom(B7), maxSubjectsPerRoom(B8), sessionCapacity(B9)
  - è§£æ sessionRules (E2:F22)
  - **é©—æ”¶**ï¼šæ­£ç¢ºè§£ææ‰€æœ‰åƒæ•¸å€¼

- [x] å»ºç«‹ `saveAllData(students)` å‡½å¼
  - æ¸…ç©ºç›®æ¨™å·¥ä½œè¡¨ï¼ˆä¿ç•™æ¨™é¡Œåˆ—ï¼‰
  - ä¸€æ¬¡å¯«å…¥æ‰€æœ‰å­¸ç”Ÿè³‡æ–™
  - **é©—æ”¶**ï¼šå–®æ¬¡ setValues å‘¼å«å®Œæˆå¯«å…¥

#### 5.5.2 å»ºç«‹å…§éƒ¨ç´”å‡½å¼
- [x] å»ºç«‹ `scheduleCommonSubjectSessionsInternal(students, columns, sessionRules)`
  - å¾ `scheduleCommonSubjectSessions()` æŠ½å–æ ¸å¿ƒé‚è¼¯
  - ç›´æ¥æ“ä½œ students é™£åˆ—ï¼ˆpass by referenceï¼‰
  - **ä¸å‘¼å«** `createExamFromSheet()` å’Œ `saveExamToSheet()`
  - **é©—æ”¶**ï¼šå‡½å¼ä¸å†ç›´æ¥æ“ä½œå·¥ä½œè¡¨

- [x] å»ºç«‹ `scheduleSpecializedSubjectSessionsInternal(students, columns, config)`
  - ä½¿ç”¨ `buildInMemoryStatistics()` å–ä»£ Exam æ¨¡å‹çµ±è¨ˆ
  - **é©—æ”¶**ï¼šå‡½å¼ä¸å†ç›´æ¥æ“ä½œå·¥ä½œè¡¨

- [x] å»ºç«‹ `assignExamRoomsInternal(students, columns, roomConfig)`
  - åŒä¸Šæ¨¡å¼é‡æ§‹
  - **é©—æ”¶**ï¼šå‡½å¼ä¸å†ç›´æ¥æ“ä½œå·¥ä½œè¡¨

- [x] å»ºç«‹ `allocateBagIdentifiersInternal(students, columns)`
  - åŒä¸Šæ¨¡å¼é‡æ§‹
  - **é©—æ”¶**ï¼šå‡½å¼ä¸å†ç›´æ¥æ“ä½œå·¥ä½œè¡¨

- [x] å»ºç«‹ `populateSessionTimesInternal(students, columns, sessionTimes)`
  - åŒä¸Šæ¨¡å¼é‡æ§‹
  - **é©—æ”¶**ï¼šå‡½å¼ä¸å†ç›´æ¥æ“ä½œå·¥ä½œè¡¨

- [x] å»ºç«‹ `updateBagAndClassPopulationsInternal(students, columns)`
  - åŒä¸Šæ¨¡å¼é‡æ§‹
  - **é©—æ”¶**ï¼šå‡½å¼ä¸å†ç›´æ¥æ“ä½œå·¥ä½œè¡¨

- [x] å»ºç«‹ `buildInMemoryStatistics(students, columns)` è¼”åŠ©å‡½å¼
  - å›å‚³ `{ bySession, byDeptGradeSubject }` çµ±è¨ˆç‰©ä»¶
  - å–ä»£ Exam æ¨¡å‹çš„ getter çµ±è¨ˆ
  - **é©—æ”¶**ï¼šçµ±è¨ˆçµæœèˆ‡åŸ Exam æ¨¡å‹ä¸€è‡´

- [x] å»ºç«‹ `sortStudentsInternal(students, columns)` æ’åºå‡½å¼
  - ä¾ç¯€æ¬¡è©¦å ´æ’åºï¼ˆç´”å‡½å¼ï¼‰
  - **é©—æ”¶**ï¼šæ’åºçµæœèˆ‡åŸå‡½å¼ä¸€è‡´

#### 5.5.3 é‡æ§‹ Pipeline å…¥å£å‡½å¼
- [x] ä¿®æ”¹ `runFullSchedulingPipeline()` ä½¿ç”¨å…§éƒ¨ç´”å‡½å¼
  - **é©—æ”¶**ï¼šI/O æ¬¡æ•¸å¾ 16-20 é™ç‚º 3-4

- [x] ä¿®æ”¹ `resumePipelineAfterManualAdjustments()` ä½¿ç”¨å…§éƒ¨ç´”å‡½å¼
  - **é©—æ”¶**ï¼šI/O æ¬¡æ•¸å¾ 10-12 é™ç‚º 2

#### 5.5.4 ä¿æŒå‘å¾Œç›¸å®¹
- [x] ä¿ç•™åŸæœ‰å…¬é–‹å‡½å¼ä½œç‚ºåŒ…è£å™¨
  - åŸæœ‰å…¬é–‹å‡½å¼ï¼ˆscheduleCommonSubjectSessions ç­‰ï¼‰ä¿æŒä¸è®Šï¼Œä¾›é¸å–®å€‹åˆ¥å‘¼å«ä½¿ç”¨
  - **é©—æ”¶**ï¼šé¸å–®ä¸­çš„å€‹åˆ¥æ­¥é©Ÿä»å¯æ­£å¸¸åŸ·è¡Œ

#### 5.5.5 ç°¡åŒ–é ˜åŸŸæ¨¡å‹ï¼ˆå¯é¸ï¼Œä¸­å„ªå…ˆï¼‰
- [ ] è©•ä¼°æ˜¯å¦ä¿ç•™ `createStatisticsContainer()`
  - è‹¥å…§éƒ¨ç´”å‡½å¼ä½¿ç”¨ `buildInMemoryStatistics()`ï¼Œå¯èƒ½ä¸å†éœ€è¦
- [ ] ç§»é™¤ `statistics()` æ–¹æ³•ï¼ˆåƒ…ä¿ç•™å…·åå±¬æ€§ï¼‰
- [ ] ç§»é™¤ `getAvailableStatistics()` æ–¹æ³•
- [ ] **é©—æ”¶**ï¼šç¨‹å¼ç¢¼æ¸›å°‘ç´„ 40 è¡Œï¼ŒåŠŸèƒ½ä¸è®Š

#### 5.5.6 æ•ˆèƒ½é©—è­‰
- [ ] è¨˜éŒ„å„ªåŒ–å‰ `runFullSchedulingPipeline()` åŸ·è¡Œæ™‚é–“
- [ ] è¨˜éŒ„å„ªåŒ–å¾ŒåŸ·è¡Œæ™‚é–“
- [ ] **é©—æ”¶**ï¼šåŸ·è¡Œæ™‚é–“æ¸›å°‘ 50% ä»¥ä¸Šï¼ˆç›®æ¨™ï¼š60-70%ï¼‰

#### 5.5.7 æäº¤éšæ®µ 5.5
- [ ] Git commit with message "perf(scheduling): æ¡ç”¨å–®æ¬¡è®€å–-Pipelineè™•ç†-å–®æ¬¡å¯«å…¥æ¨¡å¼"
- [ ] è¨˜éŒ„æ•ˆèƒ½æå‡æ•¸æ“š

---

## éšæ®µ 0: æº–å‚™åŸºæº–æ¸¬è©¦è³‡æ–™
- [ ] 0.1 å»ºç«‹è©¦ç®—è¡¨æ¸¬è©¦å‰¯æœ¬
  - è¤‡è£½æ­£å¼ç’°å¢ƒçš„è©¦ç®—è¡¨
  - é‡æ–°å‘½åç‚ºã€Œè£œè€ƒç·¨æ’ç³»çµ±_æ¸¬è©¦_YYYYMMDDã€
  - ç¢ºä¿æ‰€æœ‰å·¥ä½œè¡¨éƒ½å·²è¤‡è£½
- [ ] 0.2 åŸ·è¡Œç¾æœ‰æµç¨‹ä¸¦è¨˜éŒ„åŸºæº–
  - åŸ·è¡Œã€Œæ­¥é©Ÿ 1. ç”¢å‡ºå…¬å‘Šç”¨è£œè€ƒåå–®ã€è©¦å ´è¨˜éŒ„è¡¨ã€
  - åŒ¯å‡ºã€Œæ’å…¥è€ƒç¨‹çš„è£œè€ƒåå–®ã€ç‚º CSVï¼ˆbaseline_scheduled.csvï¼‰
  - åŒ¯å‡ºã€Œå…¬å‘Šç‰ˆè£œè€ƒå ´æ¬¡ã€ç‚º CSVï¼ˆbaseline_bulletin.csvï¼‰
  - åŒ¯å‡ºã€Œè©¦å ´è¨˜éŒ„è¡¨ã€ç‚º CSVï¼ˆbaseline_classrooms.csvï¼‰
  - è¨˜éŒ„åŸ·è¡Œæ™‚é–“åˆ° benchmark.txt
- [ ] 0.3 å»ºç«‹åŸºæº–é©—è­‰è…³æœ¬ï¼ˆoptionalï¼‰
  - æ’°å¯« compare.sh æ¯”å° CSV æª”æ¡ˆ
  - æˆ–ä½¿ç”¨è©¦ç®—è¡¨çš„ COUNTIF å…¬å¼é©—è­‰äººæ•¸

## éšæ®µ 1: å»ºç«‹æ ¸å¿ƒæœå‹™å±¤
- [x] 1.1 å»ºç«‹ `examService.js` æª”æ¡ˆ
  - åœ¨å°ˆæ¡ˆæ ¹ç›®éŒ„å»ºç«‹æª”æ¡ˆ
  - åŠ å…¥æª”æ¡ˆæ¨™é ­è¨»è§£ï¼ˆç”¨é€”èªªæ˜ï¼‰
  - **é©—æ”¶**ï¼šæª”æ¡ˆå­˜åœ¨ä¸”åŒ…å«æ­£ç¢ºçš„ JSDoc è¨»è§£
- [x] 1.2 å¯¦ä½œ `getColumnIndices()` å‡½å¼
  - å›å‚³ç‰©ä»¶åŒ…å«æ‰€æœ‰æ¬„ä½å°æ˜ ï¼ˆdepartment, grade, class, seat, ...ï¼‰
  - ä½¿ç”¨ `FILTERED_RESULT_SHEET` çš„æ¨™é¡Œåˆ—
  - **é©—æ”¶**ï¼šåŸ·è¡Œ `Logger.log(getColumnIndices())` é¡¯ç¤ºæ­£ç¢ºå°æ˜ 
- [x] 1.3 å¯¦ä½œ `createExamFromSheet()` å‡½å¼
  - è®€å–ã€Œæ’å…¥è€ƒç¨‹çš„è£œè€ƒåå–®ã€å·¥ä½œè¡¨
  - å»ºç«‹ `createExamRecord(maxSessions, maxRooms)`
  - æ ¹æ“šç¯€æ¬¡æ¬„å¡«å…… `exam.sessions[i].students`
  - **é©—æ”¶**ï¼š`exam.population` ç­‰æ–¼å·¥ä½œè¡¨ç¸½åˆ—æ•¸ - 1
- [x] 1.4 å¯¦ä½œ `saveExamToSheet(exam)` å‡½å¼
  - æ¸…ç©ºç›®æ¨™å·¥ä½œè¡¨ï¼ˆä¿ç•™æ¨™é¡Œåˆ—ï¼‰
  - å¾ `classroom.students` èšåˆè³‡æ–™
  - å¯«å…¥å·¥ä½œè¡¨ï¼ŒæŒ‰ç¯€æ¬¡å’Œè©¦å ´æ’åº
  - **é©—æ”¶**ï¼šåŸ·è¡Œ `saveExamToSheet(createExamFromSheet())` å¾Œå·¥ä½œè¡¨å…§å®¹ä¸è®Š
- [x] 1.5 æ›´æ–° `appsscript.json` ç¢ºä¿æª”æ¡ˆè¼‰å…¥é †åº
  - æª”æ¡ˆè¼‰å…¥é †åºæ­£ç¢ºï¼šdomainModels.js â†’ examService.js â†’ scheduling.js
  - **é©—æ”¶**ï¼š`clasp push` ç„¡éŒ¯èª¤ï¼ŒApps Script ç·¨è¼¯å™¨ä¸­æª”æ¡ˆé †åºæ­£ç¢º


## éšæ®µ 2: é‡å¯«æ’ç¨‹é‚è¼¯
- [x] 2.1 é‡å¯« `scheduleCommonSubjectSessions()`
  - ä½¿ç”¨ `createExamFromSheet()` å’Œ `getColumnIndices()`
  - ä½¿ç”¨ `exam.sessions[i].students` éæ­·å­¸ç”Ÿ
  - ç§»é™¤ `buildSessionStatistics()` å‘¼å«
  - **é©—æ”¶**ï¼šåŸ·è¡Œå¾Œç¯€æ¬¡åˆ†é…æ­£ç¢º
- [x] 2.2 é‡å¯« `scheduleSpecializedSubjectSessions()`
  - ä½¿ç”¨ `createExamFromSheet()` å’Œ `session.addStudent()`
  - ä½¿ç”¨ `session.departmentGradeStatistics` æª¢æŸ¥äº’æ–¥è¦å‰‡
  - ä¿ç•™ç§‘åˆ¥å¹´ç´šäº’æ–¥é‚è¼¯
  - **é©—æ”¶**ï¼šåŸ·è¡Œå¾Œ `exam.sessions[i].departmentGradeStatistics` ç¬¦åˆäº’æ–¥è¦å‰‡
- [x] 2.3 é‡å¯« `assignExamRooms()`
  - ä½¿ç”¨ `session.departmentClassSubjectStatistics` å’Œ `classroom.addStudent()`
  - ä½¿ç”¨ `classroom.classSubjectStatistics` æª¢æŸ¥ç§‘ç›®æ•¸é™åˆ¶
  - ç§»é™¤æ‰‹å‹•å»ºç«‹ `classrooms` é™£åˆ—çš„ç¨‹å¼ç¢¼
  - **é©—æ”¶**ï¼šåŸ·è¡Œå¾Œæ‰€æœ‰ `classroom.population <= MAX_ROOM_CAPACITY`
- [x] 2.4 æ¸¬è©¦éšæ®µ 2 æ•´åˆ
  - ä¸‰å€‹å‡½å¼çš†å·²é‡å¯«å®Œæˆ
  - éœ€åœ¨ Apps Script ç’°å¢ƒæ¸¬è©¦å¯¦éš›åŸ·è¡Œ
  - **é©—æ”¶**ï¼šäººæ•¸åˆ†å¸ƒã€è©¦å ´æ•¸é‡ç¬¦åˆé æœŸ
- [x] 2.5 æäº¤éšæ®µ 2
  - æº–å‚™æäº¤ commit
  - è¨˜éŒ„æœ¬éšæ®µå®Œæˆ

## éšæ®µ 3: é‡å¯«è¼”åŠ©å‡½å¼
- [x] 3.1 é‡å¯« `allocateBagIdentifiers()`
  - ä½¿ç”¨ `exam.sessions[i].classrooms[j].students` éæ­·
  - ä½¿ç”¨ `classroom.classSubjectStatistics` è¨ˆç®—å°è¢‹æ•¸é‡
  - **é©—æ”¶**ï¼šå¤§è¢‹ã€å°è¢‹ç·¨è™Ÿé€£çºŒä¸”ç„¡é‡è¤‡
- [x] 3.2 é‡å¯« `populateSessionTimes()`
  - ä½¿ç”¨ `exam.sessions[i].classrooms[j].students` éæ­·
  - å¡«å……ç¯€æ¬¡æ™‚é–“åˆ°æ¯å€‹å­¸ç”Ÿé™£åˆ—
  - **é©—æ”¶**ï¼šæ‰€æœ‰å­¸ç”Ÿçš„ç¯€æ¬¡æ™‚é–“æ¬„ä½å·²å¡«å……
- [x] 3.3 é‡å¯« `updateBagAndClassPopulations()`
  - ä½¿ç”¨ `classroom.classSubjectStatistics` æ›´æ–°å°è¢‹äººæ•¸
  - ä½¿ç”¨ `classroom.population` æ›´æ–°å¤§è¢‹äººæ•¸
  - **é©—æ”¶**ï¼šã€Œå°è¢‹ç¸½äººæ•¸ã€å’Œã€Œç­ç´šäººæ•¸ã€æ¬„ä½æ­£ç¢º
- [x] 3.4 æ¸¬è©¦éšæ®µ 3 æ•´åˆ
  - ä¸‰å€‹è¼”åŠ©å‡½å¼çš†å·²é‡å¯«å®Œæˆ
  - éœ€åœ¨ Apps Script ç’°å¢ƒæ¸¬è©¦å¯¦éš›åŸ·è¡Œ
  - **é©—æ”¶**ï¼šè¼¸å‡ºèˆ‡é æœŸä¸€è‡´
- [x] 3.5 æäº¤éšæ®µ 3
  - æº–å‚™æäº¤ commit
  - è¨˜éŒ„æœ¬éšæ®µå®Œæˆ

## éšæ®µ 4: é‡å¯«æ’åºå‡½å¼
- [x] 4.1 é‡å¯« `sortFilteredStudentsBySubject()`
  - ä½¿ç”¨ `exam.sessions[i].classrooms[j].students` æ”¶é›†æ‰€æœ‰å­¸ç”Ÿ
  - ä½¿ç”¨ `getColumnIndices()` å–å¾—æ¬„ä½ç´¢å¼•
  - **é©—æ”¶**ï¼šä¾ç§‘ç›®ã€ç­ç´šã€åº§è™Ÿæ’åº
- [x] 4.2 é‡å¯« `sortFilteredStudentsByClassSeat()`
  - ä½¿ç”¨ Exam æ¨¡å‹æ”¶é›†å­¸ç”Ÿä¸¦æ’åº
  - **é©—æ”¶**ï¼šä¾ç­ç´šã€åº§è™Ÿã€ç¯€æ¬¡æ’åº
- [x] 4.3 é‡å¯« `sortFilteredStudentsBySessionRoom()`
  - ä½¿ç”¨ Exam æ¨¡å‹æ”¶é›†å­¸ç”Ÿä¸¦æ’åº
  - **é©—æ”¶**ï¼šä¾ç¯€æ¬¡ã€è©¦å ´ã€ç­ç´šã€åº§è™Ÿæ’åº
- [x] 4.4 æ¸¬è©¦éšæ®µ 4 æ•´åˆ
  - ä¸‰å€‹æ’åºå‡½å¼çš†å·²é‡å¯«å®Œæˆ
  - éœ€åœ¨ Apps Script ç’°å¢ƒæ¸¬è©¦å¯¦éš›åŸ·è¡Œ
  - **é©—æ”¶**ï¼šæ‰€æœ‰æ’åºåŠŸèƒ½æ­£ç¢º
- [x] 4.5 æäº¤éšæ®µ 4
  - æº–å‚™æäº¤ commit
  - è¨˜éŒ„æœ¬éšæ®µå®Œæˆ
- [ ] 4.4 æ¸¬è©¦éšæ®µ 4 æ•´åˆ
  - åŸ·è¡Œã€Œæ­¥é©Ÿ 1ã€å®Œæ•´æµç¨‹
  - æ¯”å°ã€Œå…¬å‘Šç‰ˆè£œè€ƒå ´æ¬¡ã€èˆ‡ baseline_bulletin.csv
  - æ¯”å°ã€Œè©¦å ´è¨˜éŒ„è¡¨ã€èˆ‡ baseline_classrooms.csv
  - **é©—æ”¶**ï¼šæ‰€æœ‰è¼¸å‡ºèˆ‡åŸºæº–ä¸€è‡´
- [ ] 4.5 æäº¤éšæ®µ 4
  - Git commit with message "refactor(scheduling): é‡å¯«æ’åºå‡½å¼"
  - è¨˜éŒ„æœ¬éšæ®µæ¸¬è©¦çµæœ

## éšæ®µ 5: æ¸…ç†èˆŠç¨‹å¼ç¢¼
- [x] 5.1 å¾ `scheduling.js` ç§»é™¤ `createEmptyClassroomRecord()`
  - åˆªé™¤å‡½å¼å®šç¾©ï¼ˆç´„ line 516ï¼‰
  - **é©—æ”¶**ï¼š`grep "createEmptyClassroomRecord" *.js` ç„¡çµæœ
- [x] 5.2 å¾ `scheduling.js` ç§»é™¤ `createEmptySessionRecord()`
  - åˆªé™¤å‡½å¼å®šç¾©ï¼ˆç´„ line 538ï¼‰
  - **é©—æ”¶**ï¼š`grep "createEmptySessionRecord" *.js` ç„¡çµæœ
- [x] 5.3 å¾ `scheduling.js` ç§»é™¤ `buildSessionStatistics()`
  - åˆªé™¤å‡½å¼å®šç¾©ï¼ˆç´„ line 583ï¼‰
  - å·²ç„¡ä»»ä½•å‘¼å«è™•ï¼ˆçš†å·²è¢« createExamFromSheet å–ä»£ï¼‰
  - **é©—æ”¶**ï¼š`grep "buildSessionStatistics" *.js` ç„¡çµæœ
- [x] 5.4 æ¸…ç†æœªä½¿ç”¨çš„è®Šæ•¸å’Œè¨»è§£
  - ç¢ºèªæ‰€æœ‰å‡½å¼éƒ½æœ‰æ­£ç¢ºçš„ JSDoc
  - **é©—æ”¶**ï¼šç¨‹å¼ç¢¼æ•´æ½”ï¼Œç„¡è­¦å‘Š
- [x] 5.5 æäº¤éšæ®µ 5
  - æº–å‚™æäº¤ commit
  - è¨˜éŒ„åˆªé™¤çš„ç¨‹å¼ç¢¼è¡Œæ•¸

## éšæ®µ 6: æ•´åˆæ¸¬è©¦èˆ‡æ•ˆèƒ½é©—è­‰
- [ ] 6.1 åŸ·è¡Œã€Œæ­¥é©Ÿ 1. ç”¢å‡ºå…¬å‘Šç”¨è£œè€ƒåå–®ã€è©¦å ´è¨˜éŒ„è¡¨ã€
  - åœ¨æ¸¬è©¦å‰¯æœ¬ä¸ŠåŸ·è¡Œ
  - è¨˜éŒ„åŸ·è¡Œæ™‚é–“ï¼ˆé–‹å§‹ã€çµæŸæ™‚é–“æˆ³ï¼‰
  - **é©—æ”¶**ï¼šæµç¨‹ç„¡éŒ¯èª¤ï¼Œæ‰€æœ‰å·¥ä½œè¡¨å·²æ›´æ–°
- [ ] 6.2 é©—è­‰ã€Œæ’å…¥è€ƒç¨‹çš„è£œè€ƒåå–®ã€å·¥ä½œè¡¨
  - åŒ¯å‡ºç‚º test_scheduled.csv
  - ä½¿ç”¨ `diff` æˆ–è©¦ç®—è¡¨å…¬å¼æ¯”å°
  - **é©—æ”¶**ï¼šèˆ‡ baseline_scheduled.csv å®Œå…¨ä¸€è‡´
- [ ] 6.3 é©—è­‰ã€Œå…¬å‘Šç‰ˆè£œè€ƒå ´æ¬¡ã€å·¥ä½œè¡¨
  - åŒ¯å‡ºç‚º test_bulletin.csv
  - æ¯”å°æ¬„ä½ï¼šç§‘ç›®ã€æ™‚é–“ã€ç¯€æ¬¡ã€è©¦å ´ã€åº§ä½
  - **é©—æ”¶**ï¼šèˆ‡ baseline_bulletin.csv å®Œå…¨ä¸€è‡´
- [ ] 6.4 é©—è­‰ã€Œè©¦å ´è¨˜éŒ„è¡¨ã€å·¥ä½œè¡¨
  - åŒ¯å‡ºç‚º test_classrooms.csv
  - æ¯”å°æ¬„ä½ï¼šç¯€æ¬¡ã€è©¦å ´ã€å­¸ç”Ÿæ¸…å–®
  - **é©—æ”¶**ï¼šèˆ‡ baseline_classrooms.csv å®Œå…¨ä¸€è‡´
- [ ] 6.5 åŸ·è¡Œã€Œæ­¥é©Ÿ 2. åˆä½µåˆ—å°å°è¢‹å°é¢ã€
  - ç”¢ç”Ÿ PDF æª”æ¡ˆ
  - é–‹å•Ÿæª¢æŸ¥å°é¢è³‡è¨Šæ­£ç¢ºæ€§
  - **é©—æ”¶**ï¼šPDF å…§å®¹èˆ‡é‡æ§‹å‰ç›¸åŒ
- [ ] 6.6 åŸ·è¡Œã€Œæ­¥é©Ÿ 3. åˆä½µåˆ—å°å¤§è¢‹å°é¢ã€
  - ç”¢ç”Ÿ PDF æª”æ¡ˆ
  - é–‹å•Ÿæª¢æŸ¥å°é¢è³‡è¨Šæ­£ç¢ºæ€§
  - **é©—æ”¶**ï¼šPDF å…§å®¹èˆ‡é‡æ§‹å‰ç›¸åŒ
- [ ] 6.7 æ•ˆèƒ½é©—è­‰
  - æ¯”è¼ƒåŸ·è¡Œæ™‚é–“èˆ‡åŸºæº–
  - è¨ˆç®—å·®ç•°ç™¾åˆ†æ¯”
  - **é©—æ”¶**ï¼šåŸ·è¡Œæ™‚é–“å·®ç•°åœ¨ Â±10% å…§
- [ ] 6.8 é‡è¤‡æ¸¬è©¦
  - é‡æ–°åŸ·è¡Œæ­¥é©Ÿ 6.1-6.7 å…± 3 æ¬¡
  - **é©—æ”¶**ï¼š3 æ¬¡çµæœçš†ä¸€è‡´

## éšæ®µ 7: æ–‡ä»¶æ›´æ–°
- [x] 7.1 æ›´æ–° `AGENTS.md` é ˜åŸŸæ¨¡å‹ç« ç¯€
  - âœ… å·²æ›´æ–°é‡æ§‹é€²åº¦å€å¡Šï¼Œæ¨™ç¤ºéšæ®µ 1-5 å·²å®Œæˆ
  - âœ… å·²åŒ…å«å®Œæ•´ Domain Models æ¶æ§‹èªªæ˜
  - **é©—æ”¶**ï¼šæ–‡ä»¶åæ˜ æœ€æ–°ç‹€æ…‹
- [x] 7.2 æ›´æ–° `REFACTORING_PLAN.md` ç‹€æ…‹
  - âœ… æ¨™è¨˜éšæ®µ 1-5 ç‚ºã€Œå·²å®Œæˆã€
  - âœ… åŠ å…¥å¯¦ä½œçµ±è¨ˆæ•¸æ“šå’Œå¯¦æ–½ç´€éŒ„
  - âœ… å»ºç«‹ç¨‹å¼ç¢¼å®Œæˆæª¢æŸ¥æ¸…å–®
  - **é©—æ”¶**ï¼šæ–‡ä»¶åæ˜ æœ€æ–°ç‹€æ…‹
- [ ] 7.3 å»ºç«‹é·ç§»æŒ‡å—ï¼ˆoptionalï¼‰
  - è‹¥æœ‰å…¶ä»–é–‹ç™¼è€…ï¼Œæ’°å¯« MIGRATION.md
  - èªªæ˜æ–°èˆŠ API å°ç…§
  - **é©—æ”¶**ï¼šæ–‡ä»¶æ¸…æ™°æ˜“æ‡‚
- [ ] 7.4 æ›´æ–° OpenSpec è¦ç¯„
  - å°‡ `changes/refactor-domain-models/specs/` ç§»å‹•åˆ° `specs/`
  - æ¨™è¨˜æ‰€æœ‰ requirements ç‚º CURRENT
  - **é©—æ”¶**ï¼š`openspec validate` é€šé

## éšæ®µ 8: éƒ¨ç½²æº–å‚™
- [ ] 8.1 åœ¨ `refactor/domain-models` åˆ†æ”¯æäº¤æ‰€æœ‰è®Šæ›´
  - ç¢ºä¿æ‰€æœ‰æª”æ¡ˆå·² `git add`
  - æ’°å¯«å®Œæ•´çš„ commit message
  - **é©—æ”¶**ï¼š`git status` é¡¯ç¤º clean working tree
- [ ] 8.2 å»ºç«‹ Pull Request
  - æ¨™é¡Œï¼šã€Œrefactor: é‡æ§‹æ’ç¨‹ç³»çµ±ä½¿ç”¨çµ±ä¸€é ˜åŸŸæ¨¡å‹ã€
  - å…§æ–‡ï¼šåƒè€ƒ REFACTORING_PLAN.md å’Œ design.md
  - é™„ä¸Šæ¸¬è©¦çµæœæˆªåœ–
  - **é©—æ”¶**ï¼šPR æè¿°å®Œæ•´ï¼Œæ‰€æœ‰æª¢æŸ¥é …ç›®é€šé
- [ ] 8.3 æœ€çµ‚æ‰‹å‹•æ¸¬è©¦
  - åœ¨ PR å»ºç«‹å¾Œï¼Œå†æ¬¡åŸ·è¡Œå®Œæ•´æµç¨‹
  - é‚€è«‹ä½¿ç”¨è€…ï¼ˆè¨»å†Šçµ„ï¼‰æª¢è¦–è¼¸å‡º
  - **é©—æ”¶**ï¼šä½¿ç”¨è€…ç¢ºèªè¼¸å‡ºæ­£ç¢º
- [ ] 8.4 åˆä½µåˆ° `master` åˆ†æ”¯
  - ä½¿ç”¨ squash merge æˆ– merge commitï¼ˆä¾åœ˜éšŠæ…£ä¾‹ï¼‰
  - åˆªé™¤ `refactor/domain-models` åˆ†æ”¯
  - **é©—æ”¶**ï¼šmaster åˆ†æ”¯åŒ…å«æ‰€æœ‰è®Šæ›´
- [ ] 8.5 éƒ¨ç½²åˆ°æ­£å¼ç’°å¢ƒ
  - `git checkout master`
  - `clasp push`
  - åœ¨æ­£å¼è©¦ç®—è¡¨åŸ·è¡Œä¸€æ¬¡æ¸¬è©¦
  - **é©—æ”¶**ï¼šæ­£å¼ç’°å¢ƒé‹ä½œæ­£å¸¸
- [ ] 8.6 å°å­˜ OpenSpec è®Šæ›´ææ¡ˆ
  - å°‡ `changes/refactor-domain-models/` ç§»è‡³ `changes/archive/`
  - æ›´æ–° `openspec list` ç‹€æ…‹
  - **é©—æ”¶**ï¼š`openspec list` é¡¯ç¤º 0 active changes
