# è£œè€ƒè©¦å ´ç·¨æ’ç³»çµ±

Google Apps Script è£œè€ƒè©¦å ´èˆ‡ç¯€æ¬¡ç·¨æ’è‡ªå‹•åŒ–ç³»çµ±ã€‚

## ğŸ¯ åŠŸèƒ½ç‰¹è‰²

- âœ… è‡ªå‹•ç·¨æ’è€ƒè©¦ç¯€æ¬¡èˆ‡è©¦å ´
- âœ… æ™ºæ…§åˆ†é…å­¸ç”Ÿé¿å…åŒç­åŒç§‘é›†ä¸­
- âœ… ç”¢ç”Ÿå…¬å‘Šèˆ‡åˆ—å°è³‡æ–™
- âœ… PDF åˆä½µè¼¸å‡º
- âœ… å®Œæ•´æ¸¬è©¦æ¡†æ¶

## ğŸ“ å°ˆæ¡ˆçµæ§‹

```
â”œâ”€â”€ globals.js          # å…¨åŸŸå¸¸æ•¸èˆ‡å·¥ä½œè¡¨åƒç…§
â”œâ”€â”€ helpers.js          # å…±ç”¨å·¥å…·å‡½å¼
â”œâ”€â”€ domainModels.js     # é ˜åŸŸæ¨¡å‹ï¼ˆExam, Session, Classroomï¼‰
â”œâ”€â”€ examService.js      # Exam ç‰©ä»¶æœå‹™å±¤
â”œâ”€â”€ menu.js             # å·¥ä½œåˆ—é¸å–®èˆ‡æµç¨‹æŒ‡ä»¤
â”œâ”€â”€ dataPreparation.js  # è³‡æ–™åŒ¯å…¥èˆ‡ç¯©é¸
â”œâ”€â”€ scheduling.js       # ç¯€æ¬¡èˆ‡è©¦å ´ç·¨æ’é‚è¼¯
â”œâ”€â”€ reportGeneration.js # å…¬å‘Šèˆ‡åˆ—å°è³‡æ–™ç”¢ç”Ÿ
â”œâ”€â”€ printing.js         # PDF åˆä½µè¼¸å‡º
â”œâ”€â”€ devTools.js         # é–‹ç™¼æ¸¬è©¦å·¥å…· ğŸ†•
â””â”€â”€ testRunner.js       # æ¸¬è©¦åŸ·è¡Œå™¨ ğŸ†•
```

## ğŸš€ å¿«é€Ÿé–‹å§‹

### æ–¹æ³• 1ï¼šä½¿ç”¨ç¤ºç¯„è…³æœ¬ï¼ˆæ¨è–¦ï¼‰

```bash
./demo.sh
```

æ­¤è…³æœ¬æœƒå¼•å°æ‚¨å®Œæˆï¼š
- âœ… ç’°å¢ƒæª¢æŸ¥
- âœ… ç¨‹å¼ç¢¼æ¨é€
- âœ… é–‹å•Ÿç·¨è¼¯å™¨
- âœ… éƒ¨ç½²è¨­å®š
- âœ… ç›£è¦–æ¨¡å¼

### æ–¹æ³• 2ï¼šæ‰‹å‹•åŸ·è¡Œ

```bash
# 1. æ¨é€ç¨‹å¼ç¢¼è‡³ GAS
npm run push

# 2. é–‹å•Ÿ Apps Script ç·¨è¼¯å™¨
npm run open

# 3. åŸ·è¡Œå¿«é€Ÿæ¸¬è©¦
# åœ¨ç·¨è¼¯å™¨ä¸­é¸æ“‡ä¸¦åŸ·è¡Œ: quickTest()

# 4. åŸ·è¡Œå®Œæ•´æ¸¬è©¦
# åœ¨ç·¨è¼¯å™¨ä¸­é¸æ“‡ä¸¦åŸ·è¡Œ: runAllTests()
```

## ğŸ§ª æ¸¬è©¦

### åœ¨ Apps Script ç·¨è¼¯å™¨ä¸­åŸ·è¡Œ

```javascript
// å¿«é€Ÿæ¸¬è©¦ï¼ˆé©—è­‰åŸºæœ¬åŠŸèƒ½ï¼‰
quickTest()

// å®Œæ•´æ¸¬è©¦å¥—ä»¶
runAllTests()

// å€‹åˆ¥æ¸¬è©¦å¥—ä»¶
testDomainModels()    // é ˜åŸŸæ¨¡å‹æ¸¬è©¦
testExamService()     // ExamService æ¸¬è©¦
testSchedulingLogic() // æ’ç¨‹é‚è¼¯æ¸¬è©¦
```

### æ¸¬è©¦æ¡†æ¶ç‰¹è‰²

- âœ… ç°¡æ˜“æ–·è¨€å‡½å¼åº«ï¼ˆ`assert.*`ï¼‰
- âœ… æ¸¬è©¦çµæœçµ±è¨ˆèˆ‡å ±å‘Š
- âœ… éŒ¯èª¤å †ç–Šè¿½è¹¤
- âœ… åŸ·è¡Œæ™‚é–“æ¸¬é‡

ç¯„ä¾‹ï¼š

```javascript
const suite = new TestRunner('æˆ‘çš„æ¸¬è©¦');

suite
  .test('æ¸¬è©¦æ¡ˆä¾‹ 1', () => {
    assert.equals(1 + 1, 2);
  })
  .test('æ¸¬è©¦æ¡ˆä¾‹ 2', () => {
    const exam = createExamFromSheet();
    assert.notNull(exam);
    assert.greaterThan(exam.population, 0);
  })
  .run();
```

## ğŸ› ï¸ é–‹ç™¼å·¥å…·

### Web App è¦–è¦ºåŒ–ä»‹é¢

éƒ¨ç½² Web App å¾Œå¯ä»¥ï¼š

- ğŸ“Š **å³æ™‚çµ±è¨ˆ**ï¼šç¸½äººæ•¸ã€ç¯€æ¬¡æ•¸ã€ç§‘ç›®æ•¸ã€ç§‘åˆ¥æ•¸
- ğŸ”„ **é‡æ–°è¼‰å…¥**ï¼šå³æ™‚æŸ¥çœ‹æœ€æ–°è³‡æ–™
- ğŸ’¾ **ä¸‹è¼‰å¿«ç…§**ï¼šåŒ¯å‡º JSON æ ¼å¼è³‡æ–™
- ğŸ§ª **åŸ·è¡Œæ¸¬è©¦**ï¼šç€è¦½å™¨ä¸­åŸ·è¡Œæ¸¬è©¦ï¼ˆé–‹ç™¼ä¸­ï¼‰

### é™¤éŒ¯å·¥å…·å‡½å¼

```javascript
// é¡¯ç¤º Exam ç‰©ä»¶è©³ç´°è³‡è¨Š
debugExamObject()

// å»ºç«‹è³‡æ–™å¿«ç…§
const snapshot = createDataSnapshot()

// æ¸¬é‡æ•ˆèƒ½
measurePerformance('assignSessionTimesForExam')

// æ¯”è¼ƒå¿«ç…§å·®ç•°
const diff = compareExamSnapshots(before, after)

// æ¸…é™¤æ¸¬è©¦è³‡æ–™
clearSchedulingData()

// å»ºç«‹ç¯„ä¾‹è³‡æ–™
createTestData()
```

## ğŸ“š é–‹ç™¼æŒ‡å—

### å¸¸ç”¨æŒ‡ä»¤

```bash
# é–‹ç™¼æŒ‡ä»¤
npm run push         # æ¨é€ç¨‹å¼ç¢¼è‡³ GAS
npm run pull         # æ‹‰å– GAS æœ€æ–°ç¨‹å¼ç¢¼
npm run watch        # ç›£è¦–æ¨¡å¼ï¼ˆè‡ªå‹•æ¨é€ï¼‰
npm run open         # é–‹å•Ÿ Apps Script ç·¨è¼¯å™¨

# ç‰ˆæœ¬ç®¡ç†
npm run status       # æª¢è¦–ç‰ˆæœ¬èˆ‡éƒ¨ç½²ç‹€æ…‹
npm run create-version # å»ºç«‹æ–°ç‰ˆæœ¬
npm run deploy       # æ¨é€ä¸¦éƒ¨ç½²

# é™¤éŒ¯
npm run logs         # æŸ¥çœ‹åŸ·è¡Œæ—¥èªŒ
npm run open-webapp  # é–‹å•Ÿ Web App
```

### é–‹ç™¼æµç¨‹

1. **æœ¬åœ°ç·¨è¼¯** - åœ¨ VS Code ä¸­ç·¨è¼¯ `.js` æª”æ¡ˆ
2. **æ¨é€è‡³ GAS** - åŸ·è¡Œ `npm run push`
3. **æ¸¬è©¦é©—è­‰** - åœ¨ GAS ç·¨è¼¯å™¨åŸ·è¡Œæ¸¬è©¦å‡½å¼
4. **æª¢è¦–çµæœ** - æŸ¥çœ‹æ—¥èªŒæˆ– Web App

### ç›£è¦–æ¨¡å¼é–‹ç™¼

```bash
# å•Ÿå‹•ç›£è¦–æ¨¡å¼
npm run watch

# ç¾åœ¨æ¯æ¬¡å„²å­˜æª”æ¡ˆéƒ½æœƒè‡ªå‹•æ¨é€è‡³ GAS
# åœ¨ Web App ä¸­é»æ“Šã€Œé‡æ–°è¼‰å…¥ã€å³å¯çœ‹åˆ°è®Šæ›´
```

## ğŸ—ï¸ æ¶æ§‹è¨­è¨ˆ

### é ˜åŸŸæ¨¡å‹

å°ˆæ¡ˆæ¡ç”¨ä¸‰å±¤éšå±¤å¼é ˜åŸŸæ¨¡å‹ï¼š

```
Exam (è€ƒè©¦æ´»å‹•)
  â”œâ”€â”€ sessions[] (ç¯€æ¬¡é™£åˆ—)
  â”‚     â”œâ”€â”€ students[]
  â”‚     â”œâ”€â”€ classrooms[] (è©¦å ´é™£åˆ—)
  â”‚     â”‚     â””â”€â”€ students[] (Single Source of Truth)
  â”‚     â””â”€â”€ çµ±è¨ˆå±¬æ€§
  â””â”€â”€ çµ±è¨ˆå±¬æ€§
```

è©³è¦‹ï¼š[AGENTS.md](./AGENTS.md#é ˜åŸŸæ¨¡å‹domain-models)

### è³‡æ–™æµå‘

```
å·¥ä½œè¡¨ â†’ Exam â†’ Session â†’ Classroom â†’ å·¥ä½œè¡¨
        â†“       â†“         â†“
      çµ±è¨ˆ   çµ±è¨ˆ      çµ±è¨ˆ
```

### çµ±è¨ˆå®¹å™¨

æ‰€æœ‰é ˜åŸŸç‰©ä»¶æä¾›ï¼š

- `statistics(dimensionName)` - å‹•æ…‹çµ±è¨ˆ
- `population` - è‡ªå‹•è¨ˆç®—å­¸ç”Ÿç¸½æ•¸
- `distributeToChildren(fn)` - åˆ†é…å­¸ç”Ÿè‡³å­å®¹å™¨

## ğŸ“– æ–‡ä»¶

- [QUICKSTART.md](./QUICKSTART.md) - å¿«é€Ÿé–‹å§‹æŒ‡å—
- [DEVELOPMENT.md](./DEVELOPMENT.md) - å®Œæ•´é–‹ç™¼æ–‡ä»¶
- [AGENTS.md](./AGENTS.md) - AI å”ä½œæŒ‡å¼•èˆ‡å°ˆæ¡ˆè¦ç¯„
- [REFACTORING_PLAN.md](./REFACTORING_PLAN.md) - é‡æ§‹è¨ˆç•«

## ğŸ§° æŠ€è¡“æ£§

- **åŸ·è¡Œç’°å¢ƒ**ï¼šGoogle Apps Script (V8 Runtime)
- **è©¦ç®—è¡¨**ï¼šGoogle Sheets API
- **é–‹ç™¼å·¥å…·**ï¼šclasp (Apps Script CLI)
- **æ¸¬è©¦**ï¼šè‡ªå»ºæ¸¬è©¦æ¡†æ¶
- **é™¤éŒ¯**ï¼šLogger + Web App + Chrome DevTools

## ğŸ”„ é‡æ§‹é€²åº¦

âœ… **é ˜åŸŸæ¨¡å‹é‡æ§‹å·²å®Œæˆ**ï¼ˆéšæ®µ 1-5ï¼‰

- âœ… çµ±ä¸€ä½¿ç”¨ Exam æ¨¡å‹
- âœ… æ‰€æœ‰æ’ç¨‹é‚è¼¯å·²é‡å¯«
- âœ… æ¸¬è©¦æ¡†æ¶å·²å»ºç«‹

è©³è¦‹ï¼š[openspec/changes/refactor-domain-models/](./openspec/changes/refactor-domain-models/)

## ğŸ¤ è²¢ç»

è«‹åƒè€ƒ [AGENTS.md](./AGENTS.md) äº†è§£ï¼š

- å°ˆæ¡ˆçµæ§‹èˆ‡æ¨¡çµ„å®‰æ’
- é ˜åŸŸæ¨¡å‹ä½¿ç”¨æ–¹å¼
- ç¨‹å¼é¢¨æ ¼èˆ‡å‘½åæ…£ä¾‹
- æäº¤èˆ‡ PR å®ˆå‰‡

## ğŸ“ æˆæ¬Š

ISC License

---

**æç¤º**ï¼šé¦–æ¬¡ä½¿ç”¨è«‹åŸ·è¡Œ `./demo.sh` æˆ–é–±è®€ [QUICKSTART.md](./QUICKSTART.md)
